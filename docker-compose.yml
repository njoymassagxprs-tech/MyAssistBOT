# ğŸ¤– MyAssistBOT â€” Docker Compose
# Uso: docker-compose up -d
# Logs: docker-compose logs -f

services:
  # â•â•â• API Server (core) â•â•â•
  api:
    build: .
    container_name: mybot-api
    restart: unless-stopped
    ports:
      - "${PORT:-7777}:7777"
    env_file: .env
    environment:
      - PORT=7777
      - NODE_ENV=production
    volumes:
      - ./outputs:/app/outputs
      - ./user_data:/app/user_data
      - ./logs:/app/logs
      - ./plugins:/app/plugins
    healthcheck:
      test: ["CMD", "node", "-e", "const http = require('http'); http.get('http://localhost:7777/api/status', r => process.exit(r.statusCode === 200 ? 0 : 1)).on('error', () => process.exit(1))"]
      interval: 30s
      timeout: 5s
      retries: 3

  # â•â•â• Telegram Bot (opcional â€” descomenta para usar) â•â•â•
  # telegram:
  #   build: .
  #   container_name: mybot-telegram
  #   restart: unless-stopped
  #   command: ["node", "bots/telegram.js"]
  #   env_file: .env
  #   environment:
  #     - API_URL=http://api:7777
  #   depends_on:
  #     api:
  #       condition: service_healthy

  # â•â•â• Discord Bot (opcional â€” descomenta para usar) â•â•â•
  # discord:
  #   build: .
  #   container_name: mybot-discord
  #   restart: unless-stopped
  #   command: ["node", "bots/discord.js"]
  #   env_file: .env
  #   environment:
  #     - API_URL=http://api:7777
  #   depends_on:
  #     api:
  #       condition: service_healthy

  # â•â•â• Webhook Server (opcional) â•â•â•
  # webhook:
  #   build: .
  #   container_name: mybot-webhook
  #   restart: unless-stopped
  #   command: ["node", "webhook/server.js"]
  #   ports:
  #     - "${WEBHOOK_PORT:-3002}:3002"
  #   env_file: .env
  #   depends_on:
  #     api:
  #       condition: service_healthy

volumes:
  outputs:
  user_data:
  logs:
  plugins:
